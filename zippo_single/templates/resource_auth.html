{% extends 'base.html' %}

{% block titile %}
resource
{% endblock %}
{% load staticfiles %}

{% block content %}
			<aside class="sidebar-menu fixed">
				<div class="sidebar-inner scrollable-sidebar">
					<div class="main-menu">
						<ul class="accordion">
							<li class="menu-header">
								Main Menu
							</li>
							<li class="bg-palette1 active">
								<a href="{% url 'index' %}">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-home fa-lg"></i></span>
										<span class="text m-left-sm">数据总览</span>
									</span>
									<span class="menu-content-hover block">
										Home
									</span>
								</a>
							</li>
							<!--li class="bg-palette2">
								<a href="landing/landing.html">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-desktop fa-lg"></i></span>
										<span class="text m-left-sm">Landing</span>
									</span>
									<span class="menu-content-hover block">
										Landing
									</span>
								</a>
							</li-->
							<li class="bg-palette3">
								<a href="{% url 'org:device_detail' %}">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-list fa-lg"></i></span>
										<span class="text m-left-sm">详细数据</span>
										<!--span class="submenu-icon"></span-->
									</span>
									<span class="menu-content-hover block">
										Detail
									</span>
								</a>
							</li>
                            <li class="bg-palette4">
								<a href="{% url 'device:device_resource' %}">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-tags fa-lg"></i></span>
										<span class="text m-left-sm">素材更新</span>
									</span>
									<span class="menu-content-hover block">
										update resource
									</span>
								</a>
							</li>
                            <li class="bg-palette5">
								<a href="{% url 'device:update_software' %}">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-tags fa-lg"></i></span>
										<span class="text m-left-sm">软件更新</span>
									</span>
									<span class="menu-content-hover block">
										update software
									</span>
								</a>
							</li>
							<!--li class="openable bg-palette4">
								<a href="#">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-tags fa-lg"></i></span>
										<span class="text m-left-sm">详细数据</span>
										<span class="submenu-icon"></span>
									</span>
									<span class="menu-content-hover block">
										UI Kits
									</span>
								</a>
								<ul class="submenu">
									<!--li><a href="ui_element.html"><span class="submenu-label">Basic Elements</span></a></li>
									<li><a href="button.html"><span class="submenu-label">Button & Icons</span></a></li-->
									<!--li class="openable">
										<a href="#">
											<small class="badge badge-success badge-square bounceIn animation-delay2 m-left-xs pull-right">2</small>
											<span class="submenu-label">详细数据</span>
										</a>
										<ul class="submenu third-level">
											<li><a href="static_table.html"><span class="submenu-label">销售详细数据</span></a></li>
											<li><a href="datatable.html"><span class="submenu-label">人流量详细数据</span></a></li>
											<li class="active"><a href="satisfaction.html"><span class="submenu-label">客户满意度数据</span></a></li>
										</ul>
									</li>
									<!--li><a href="widget.html"><span class="submenu-label">Widget</span></a></li>
									<li><a href="tab.html"><span class="submenu-label">Tab</span></a></li>
									<li><a href="calendar.html"><span class="submenu-label">Calendar</span></a></li>
									<li><a href="treeview.html"><span class="submenu-label">Treeview</span></a></li>
									<li><a href="nestable_list.html"><span class="submenu-label">Nestable Lists</span></a></li-->
								<!--/ul>
							</li-->
							<!--li class="bg-palette1">
								<a href="inbox.html">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-envelope fa-lg"></i></span>
										<span class="text m-left-sm">Inboxs</span>
										<small class="badge badge-danger badge-square bounceIn animation-delay5 m-left-xs">5</small>
									</span>
									<span class="menu-content-hover block">
										Inboxs
									</span>
								</a>
							</li-->
							<!--li class="bg-palette2">
								<a href="timeline.html">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-clock-o fa-lg"></i></span>
										<span class="text m-left-sm">Timeline</span>
										<small class="badge badge-warning badge-square bounceIn animation-delay6 m-left-xs pull-right">7</small>
									</span>
									<span class="menu-content-hover block">
										Timeline
									</span>
								</a>
							</li-->
							<!--li class="menu-header">
								Others
							</li-->
							<!--li class="openable bg-palette3">
								<a href="#">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-gift fa-lg"></i></span>
										<span class="text m-left-sm">Extra Pages</span>
										<span class="submenu-icon"></span>
									</span>
									<span class="menu-content-hover block">
										Pages
									</span>
								</a>
								<ul class="submenu">
									<li><a href="signin.html"><span class="submenu-label">Sign in</span></a></li>
									<li><a href="signup.html"><span class="submenu-label">Sign Up</span></a></li>
									<li><a href="lockscreen.html"><span class="submenu-label">Lock Screen</span></a></li>
									<li><a href="profile.html"><span class="submenu-label">Profile</span></a></li>
									<li><a href="gallery.html"><span class="submenu-label">Gallery</span></a></li>
									<li><a href="blog.html"><span class="submenu-label">Blog</span></a></li>
									<li><a href="single_post.html"><span class="submenu-label">Single Post</span></a></li>
									<li><a href="pricing.html"><span class="submenu-label">Pricing</span></a></li>
									<li><a href="invoice.html"><span class="submenu-label">Invoice</span></a></li>
									<li><a href="error404.html"><span class="submenu-label">Error404</span></a></li>
									<li><a href="blank.html"><span class="submenu-label">Blank</span></a></li>
								</ul>
							</li-->
							<!--li class="openable bg-palette4">
								<a href="#">
									<span class="menu-content block">
										<span class="menu-icon"><i class="block fa fa-list fa-lg"></i></span>
										<span class="text m-left-sm">Menu Level</span>
										<span class="submenu-icon"></span>
									</span>
									<span class="menu-content-hover block">
										Menu
									</span>
								</a>
								<ul class="submenu">
									<li class="openable">
										<a href="signin.html">
											<span class="submenu-label">menu 2.1</span>
											<small class="badge badge-success badge-square bounceIn animation-delay2 m-left-xs pull-right">3</small>
										</a>
										<ul class="submenu third-level">
											<li><a href="#"><span class="submenu-label">menu 3.1</span></a></li>
											<li><a href="#"><span class="submenu-label">menu 3.2</span></a></li>
											<li class="openable">
												<a href="#">
													<span class="submenu-label">menu 3.3</span>
													<small class="badge badge-danger badge-square bounceIn animation-delay2 m-left-xs pull-right">2</small>
												</a>
												<ul class="submenu fourth-level">
													<li><a href="#"><span class="submenu-label">menu 4.1</span></a></li>
													<li><a href="#"><span class="submenu-label">menu 4.2</span></a></li>
												</ul>
											</li>
										</ul>
									</li>
									<li><a href="#"><span class="submenu-label">menu 2.2</span></a></li>
								</ul>
							</li-->
						</ul>
					</div>	
					<!--div class="sidebar-fix-bottom clearfix">
						<div class="user-dropdown dropup pull-left">
							<a href="#" class="dropdwon-toggle font-18" data-toggle="dropdown"><i class="ion-person-add"></i>
							</a>
							<ul class="dropdown-menu">
								<li>
									<a href="inbox.html">
										Inbox
										<span class="badge badge-danger bounceIn animation-delay2 pull-right">1</span>
									</a>
								</li>			  
								<li>
									<a href="#">
										Notification
										<span class="badge badge-purple bounceIn animation-delay3 pull-right">2</span>
									</a>
								</li>			  
								<li>
									<a href="#" class="sidebarRight-toggle">
										Message
										<span class="badge badge-success bounceIn animation-delay4 pull-right">7</span>
									</a>
								</li>			  	  
								<li class="divider"></li>
								<li>
									<a href="#">Setting</a>
								</li>			  	  
							</ul>
						</div>
						<a href="lockscreen.html" class="pull-right font-18"><i class="ion-log-out"></i></a>
					</div-->
				</div><!-- sidebar-inner -->
			</aside>
			<div class="main-container">
				<div class="padding-md">
					<div class="row">
						<div class="col-sm-6">
							<div class="page-title">
								<h4>资源更新</h4>
							</div>
							<!--div class="page-sub-header">
								Welcome Back, John Doe , <i class="fa fa-map-marker text-danger"></i> London
							</div-->
						</div>

					</div>

							<div class="row "   >
								
								
									<!--div class="col-lg-2">
									<select id="region" onchange="Get_Next_Place('region','Get_city')"  class="btn btn-default dropdown-toggle  btn-block" name="region">
											<option id="Not_data1" > 区&nbsp;&nbsp;域</option>
											{% for region in all_region %}
												<option id={{ region.id }} value={{ region.name }}>{{ region.name }}</option>
											{% endfor %}
										
									</select>
									</div>
									<div class="col-lg-2">
									<select id="city" onchange="Get_Next_Place('city','Get_store')" class="btn btn-default dropdown-toggle  btn-block" name="city">
										<option id="Not_data2" >城&nbsp;&nbsp;市</option>
									</select>
									</div>
									<div class="col-lg-2">
									<select id="store" class="btn btn-default dropdown-toggle  btn-block"  name="store">
											<option id="Not_data3" >门&nbsp;&nbsp;店</option>
									</select>
									</div>

                                    <div class="col-lg-6">
									</div-->
                                    
                                    
                                    

					<!--table class="table table-striped" id="sourceTable">
						<thead>
                        <div class="row">
							<tr>
                            <div class="col-sm-1">
								<th>区域</th>
                            </div>
                            <div class="col-sm-1">
								<th>城市</th>
                            </div>
                            <div class="col-sm-1">
								<th>门店</th>
                            </div>
                                {% for updata in update_list %}
                                <div class="col-sm-1">
								<th>第{{updata}}个更新文档</th>
                                </div>
                                {% endfor %}
							</tr>
                           </div>
						</thead>
						<tbody>
                            {% load pagination_tags %} 
                            {% autopaginate data_list 20 as data_list_page %}
                            
                                {% for data in data_list_page %}
                                <tr>
                                    <div class="col-sm-1">
                                    <td>{{ data.regionname }}</td>
                                    </div>
                                    <div class="col-sm-1">
                                    <td>{{ data.cityname }}</td>
                                    </div>
                                    <div class="col-sm-1">
                                    <form method="post" action="/device/resource_update/" name="resource_update_form" enctype="multipart/form-data">
                                    <div class="form-group">
                                    <td >{{ data.name }}</td>
                                    </div>
                                    <input name="updata_store" value={{ data.name }} type="hidden">
                                    {% for x in update_list %}
                                    <td>
										<div class="col-sm-12">
											<input type="file" class="col-sm-12" name="updata_resource" >
										</div><!-- /.col -->
                                        <!--input name="updata" value={{x}} type="hidden" >
                                    </td>
                                    {% endfor %}
									</div><!-- /form-group -->
                                    <!--div class="col-lg-12">
                                    <button type="submit" class="btn btn-primary marginTB-xs pull-right" >提交</button>
                                    </div>
                                </tr>
								{% endfor %}
                             {% csrf_token %}
								</form>
                             {% paginate %}
						</tbody>
					</table-->
                                {% for updata in updata_list %}
							</div>
                              <label  >确认要升级{{updata}}</label>
                                <input type="text" id="msg" value={{updata}}>
                                   
                                    <input type="button" value="确认升级" onclick="send()" />
                                     
                            </div>
                            {%endfor%}
					<!--div class="smart-widget">
						<div class="smart-widget-inner">
							
							<div class="smart-widget-body">
                      
							</div>

						</div>
					
					</div><!-- ./smart-widget -->
                                
									<!--div class="row "  class="smart-widget-inner" >
                                        <div class="col-lg-6">
                                            <button type="button" class="btn btn-primary marginTB-xs pull-left"><i class="fa fa-save m-right-xs"></i>一键生成报表</button>
                                        </div>
                                        <div class="col-lg-3">
                                            <button type="submit" onclick="beforeSubmit()" class="btn btn-primary marginTB-xs pull-right" >提交</button>
                                        </div>
                                    </div-->
								
                                
							</div>
				</div><!-- ./padding-md -->
			</div><!-- /main-container -->
			{% endblock %}
{% block custom2_js %}
<!--script src="{% static '/js/jquery-1.11.1.min.js' %} "></script-->
<!-- Simplify -->


<script language="JavaScript">   
var today=new Date();  
var submitTime=today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();   
$("#date").attr('value',submitTime);  
</script> 




<script type="text/javascript">
        var Region_select,City_select,Store_select
        //用来获得option元素中selected属性为true的元素的id
        function Get_Selected_Id(region){
            var pro = document.getElementById(region);
            var Selected_Id = pro.options[pro.selectedIndex].id;
            console.log("Get_Selected_Id:"+Selected_Id);  //测试使用
            return Selected_Id;         //返回selected属性为true的元素的id
        }
 
        //执行相应的动作，调用相关数据请求函数
        function Get_Next_Place(This_Place_ID,Action){
            var Selected_Id = Get_Selected_Id(This_Place_ID);   //Selected_Id用来记录当前被选中的省或市的ID
            if(Action=='Get_city')                            //从而可以在下一个级联中加载相应的市或县
                Get_City_Data(Selected_Id);
            else if(Action=='Get_store')
                Get_Store_Data(Selected_Id);
        }
 
        //向服务器请求城市列表数据并调用添加城市函数
        function Get_City_Data(Region_Selected_Id){    //这里的Selected_Id应该是被选中的省份的ID
            console.log("Region_Selected_Id:"+Region_Selected_Id);   //测试使用
            
            if(Region_Selected_Id == 'Not_data1'){    //如果选择了"Province"选项，则表示重置当前City和Country的选项内容，不会向服务器请求数据
                $("#city").empty();
                $("#city").append("<option id='Not_data2'>城&nbsp;&nbsp;市</option>");
                $("#store").empty();
                $("#store").append("<option id='Not_data3'>门&nbsp;&nbsp;店</option>");
            }else{      //否则就会向服务器请求数据
                $.getJSON('/org/GetCityData/',{'region':Region_Selected_Id},function(City_list){
                    console.log(City_list);      //测试使用
                    Add_city(City_list);    //调用添加城市选项函数
                });
            }
        }
 
        //在当前页面添加城市选项
        function Add_city(City_list){
            $("#city").empty();
            $("#city").append("<option id='Not_data2'>城&nbsp;&nbsp;市</option>");
            $("#store").empty();
            $("#store").append("<option id='Not_data3'>门&nbsp;&nbsp;店</option>");
            //上面的两次清空与两次添加是为了保持级联的一致性
            for(var index in City_list){     //获得城市列表中的城市索引
                //添加内容的同时在option标签中添加对应的城市ID
                var text =  "<option"+" id='"+City_list[index]+"'>"+City_list[index]+"</option>";
                $("#city").append(text);
                console.log(text);  //用来观察生成的text数据
            }
        }
 
        //向服务器请求门店列表数据并调用添加门店函数
       function Get_Store_Data(City_Selected_Id){
           console.log("City_Selected_Id:"+City_Selected_Id);   //测试使用
           
           if(City_Selected_Id == 'Not_data2'){     //如果选择了City选项，则表示重置当前Country的选项内容，不会向服务器请求数据
               $("#store").empty();
               $("#store").append("<option id='Not_data3'>门&nbsp;&nbsp;店</option>");
               //上面的清空与添加是为了保持级联的一致性
           }else{   //否则就会向服务器请求数据
               var Region_Selected_ID = Get_Selected_Id("region");  //获得被选中省的ID，从而方便从服务器中加载数据
               $.getJSON('/org/GetStoreData/',{'region':Region_Selected_ID,'City':City_Selected_Id},function(Store_list){
//                   console.log(Country_list);    //测试使用
                    Add_store(Store_list);   //调用添加门店选项函数
                   Region_select=Region_Selected_ID;
                   console.log("REGION=",Region_select)
                   City_select=City_Selected_Id;
                   console.log("CITY=",City_select)
                   
        
               });
           }

        }
 
        //在当前页面添加门店选项
        function Add_store(Store_list){
            $("#store").empty();
            $("#store").append("<option id='Not_data3'>门&nbsp;&nbsp;店</option>");
            //上面的清空与添加是为了保持级联的一致性
            for(var index in Store_list){     //获得县区列表中的县区索引
                //添加内容的同时在option标签中添加对应的城市ID
                var text = "<option"+" id='"+Store_list[index]+"'>"+Store_list[index]+"</option>";
                $("#store").append(text);
                console.log(Store_list[index]);  //用来观察生成的text数据
                Store_select=Store_list[index];
            }
        }
        
         
		 /*
		$(function() {
            if (localStorage.getItem('region')) {
                $("#region option").eq(localStorage.getItem('region')).prop('selected', true);
            }
 
            $("#region").on('change', function() {
                localStorage.setItem('region', $('option:selected', this).index());
				console.log(localStorage.setItem('region', $('option:selected', this).index()));
            });

            if (localStorage.getItem('city')) {
                $("#city option").eq(localStorage.getItem('city')).prop('selected', true);
            }
 
            $("#city").on('change', function() {
                localStorage.setItem('city', $('option:selected', this).index());
				console.log(localStorage.setItem('city', $('option:selected', this).index()));
            });

            if (localStorage.getItem('store')) {
                $("#store option").eq(localStorage.getItem('store')).prop('selected', true);
            }
 
            $("#store").on('change', function() {
                localStorage.setItem('store', $('option:selected', this).index());
            });

            if (localStorage.getItem('day_select')) {
                $("#day_select option").eq(localStorage.getItem('day_select')).prop('selected', true);
            }
 
            $("#day_select").on('change', function() {
                localStorage.setItem('day_select', $('option:selected', this).index());
            });
        });
		 */
		 /*
		var Region_select=document.getElementById("region").value;
        var City_select=document.getElementById("city").value;
        var Store_select=document.getElementById("store").value;
        var day_select= document.getElementById("day_select").value;
        function upload_data(){
        jsPost('/org/csv/', {
                'Region_id': Region_select,
                'City_id': City_select,
                'Store_id':Store_select,
                'day_select':day_select
                });
        }
        var jsPost = function(action, values) {
        var id = Math.random();
        document.write('<form id="post' + id + '" name="post'+ id +'" action="' + action + '" method="post">');
        for (var key in values) {
        document.write('<input type="hidden" name="' + key + '" value="' + values[key] + '" />');
        console.log(values[key]);
            }
        document.write('</form>');  
        document.getElementById('post' + id).submit();
        }
        */


</script>
{% endblock %}